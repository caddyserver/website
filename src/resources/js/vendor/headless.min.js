(()=>{class t extends HTMLElement{execEndpoint=`${o}/headless/execute/`;connectedCallback(){this.playground=window.techPlaygroundDefinitions[this.getAttribute("playground")];this.version=this.getAttribute("version")||this.playground.versions[0];this.showVersionSelector=(this.getAttribute("show-version-selector")||"true")=="true";this.showFileNames=(this.getAttribute("show-file-names")||"true")=="true";this.codeEditable=(this.getAttribute("editable")||"true")=="true";this.controlsLocation=this.getAttribute("controls")||"bottom";this.outputLocation=this.getAttribute("output")||"bottom";this.outputStyle=this.getAttribute("output-style")||"default";if(this.outputStyle==="default"){this.outputStyle=this.playground.defaults.output_style}this.outputOrder=this.getAttribute("output-order")||"default";if(this.outputOrder==="default"){this.outputOrder=this.playground.defaults.output_order}this.outputOrder=this.outputOrder.split(",");this.classList.add(`tech-playground-${this.playground.name}`);this.mapCodeBlocks();this.setupControls();if(this.showFileNames){for(const[t,e]of Object.entries(this.fileCodeBlockMap)){const o=document.createElement("div");o.textContent=t;o.classList.add("code-title");e.parentElement.insertBefore(o,e)}}}execute(){this.poweredByIndicator.style.display="none";this.loadingIdicator.style.display="inline-block";const t={};for(const[s,n]of Object.entries(this.fileCodeBlockMap)){t[s]=n.textContent.trim()}const e={playground:this.playground.name,version:this.version,files:t};const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};fetch(this.execEndpoint,o).then(t=>t.json()).then(t=>{while(this.outputElement.firstChild){this.outputElement.removeChild(this.outputElement.firstChild)}this.loadingIdicator.style.display="none";this.poweredByIndicator.style.display="inline-block";if(t.success){if(this.outputStyle=="boxed"){this.makeBoxedOutput(t)}else if(this.outputStyle=="plain"){this.makePlainOutput(t)}else{this.showError("Widget configuration error","Invalid output-style")}}else{this.showError("tech-playground.com error",t.message)}}).catch(t=>{console.error("Error during execution:",t);this.showError("Error connecting to tech-playground.com",t)})}makeBoxedOutput(t){this.outputOrder.includes("server.stdout")&&this.outputElement.appendChild(this.makeBoxedOutputElement("Server stdout",t.server.stdout));this.outputOrder.includes("server.stderr")&&this.outputElement.appendChild(this.makeBoxedOutputElement("Server stderr",t.server.stderr));this.outputOrder.includes("command.stdout")&&this.outputElement.appendChild(this.makeBoxedOutputElement("Command stdout",t.command.stdout));this.outputOrder.includes("command.stderr")&&this.outputElement.appendChild(this.makeBoxedOutputElement("Command stderr",t.command.stderr))}makeBoxedOutputElement(t,e,o=true){const s=document.createElement("details");const n=document.createElement("summary");const i=document.createElement("pre");n.textContent=t;s.appendChild(n);i.textContent=e;s.appendChild(i);if(e!=""){s.open=true}return s}makePlainOutput(t){this.outputOrder.includes("server.stdout")&&this.outputElement.appendChild(this.makePlainOutputElement(t.server.stdout));this.outputOrder.includes("server.stderr")&&this.outputElement.appendChild(this.makePlainOutputElement(t.server.stderr));this.outputOrder.includes("command.stdout")&&this.outputElement.appendChild(this.makePlainOutputElement(t.command.stdout));this.outputOrder.includes("command.stderr")&&this.outputElement.appendChild(this.makePlainOutputElement(t.command.stderr))}makePlainOutputElement(t){const e=document.createElement("pre");e.textContent=t;return e}showError(t,e){const o=document.createElement("div");o.classList.add("tech-playground-error");const s=document.createElement("span");s.classList.add("tech-playground-error-title");s.textContent=t;const n=document.createElement("span");n.classList.add("tech-playground-error-message");n.textContent=e;o.appendChild(s);o.appendChild(n);this.outputElement.appendChild(o)}mapCodeBlocks(){const o=this.querySelectorAll("code");if(o.length<this.playground.files){throw new Error("Not enough code elements found")}const s={};this.playground.files.forEach((t,e)=>{s[t]=o[e]});this.fileCodeBlockMap=s}toggleEditMode(){this.editButton.textContent=this.editButton.textContent==="Edit"?"Exit":"Edit";for(const t of Object.values(this.fileCodeBlockMap)){const e=t.getAttribute("contenteditable")==="true";t.setAttribute("contenteditable",e?"false":"true")}}setupControls(){const t=document.createElement("div");t.classList=["tech-playground-controls"];const e=document.createElement("button");e.classList.add("run-button");e.textContent="Run";e.addEventListener("click",()=>{this.execute()});this.runButton=e;t.appendChild(e);if(this.codeEditable){const i=document.createElement("button");i.classList.add("edit-button");i.textContent="Edit";i.addEventListener("click",()=>{this.toggleEditMode()});this.editButton=i;t.appendChild(i)}if(this.showVersionSelector){const r=document.createElement("select");this.playground.versions.forEach(t=>{const e=document.createElement("option");e.value=t;e.textContent=t;if(t===this.version){e.selected=true}r.appendChild(e)});r.classList.add("version-selector");r.addEventListener("change",()=>{this.version=r.value});this.versionSelector=r;t.appendChild(r)}const o=document.createElement("span");o.classList.add("loading-indicator");o.textContent="Running your code...";o.style.display="none";this.loadingIdicator=o;t.appendChild(o);const s=document.createElement("span");s.classList.add("powered-by-indicator");s.textContent="Powered by tech-playground.com";s.style.display="none";this.poweredByIndicator=s;t.appendChild(s);const n=document.createElement("div");this.outputElement=n;n.classList.add("tech-playground-output");n.classList.add("boxed");if(this.controlsLocation==="top"&&this.outputLocation==="top"){this.insertBefore(n,this.firstChild);this.insertBefore(t,this.firstChild)}else if(this.controlsLocation==="top"&&this.outputLocation==="bottom"){this.insertBefore(t,this.firstChild);this.appendChild(n)}else if(this.controlsLocation==="bottom"&&this.outputLocation==="top"){this.insertBefore(n,this.firstChild);this.appendChild(t)}else if(this.controlsLocation==="bottom"&&this.outputLocation==="bottom"){this.appendChild(t);this.appendChild(n)}else{throw new Error(`Invalid controls location: ${this.controlsLocation}`)}}}async function e(){try{const t=await fetch(`${o}/headless/playgrounds/`);const e=await t.json();window.techPlaygroundDefinitions=e}catch(t){console.error("Error fetching playground definitions:",t);throw t}}const o=document.body.getAttribute("tech-playground-api-base")||"https://headless.tech-playground.com";if(!customElements.get("tech-playground")||!window.techPlaygroundDefinitions){e().then(()=>{customElements.define("tech-playground",t)})}})();